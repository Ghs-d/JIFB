{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ noticia.titulo }}</title>
<link rel="stylesheet" href="{% static 'css/pagina.css' %}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  {% include 'navbar.html'%}



  <div class="noticia">
    <h1> {{ noticia.titulo }}<h1>
    <div class="info">Publicado em {{ noticia.created }} por <span class="autor">{{ noticia.autor }}</span></div>

    
    
    <img src="{% static 'media/' %}{{ noticia.capa_noticia }}" alt="Capa da Notícia" class="capa">

    <div class="conteudo">
      {{ conteudo_html|safe }}
    </div>
   
  {% if user.is_authenticated %}
  <div class="comentario-card">
    <h2 class="comentario-titulo">Deixe um comentário</h2>
    <form id="form-comentario" class="comentario-form">
      <div class="input-group">
        <textarea id="comentario" placeholder="Escreva seu comentário..." required></textarea>
        <label for="comentario">Comentário</label>
      </div>
      <button type="submit">Enviar</button>
    </form>
  </div>

{% else %}
  <div class="comentario-card">
    <p class="comentario-login-texto">Você precisa estar <a href="{% url 'login' %}">logado</a> para comentar.</p>
  </div>
{% endif %}
<hr class="line">

<div class="social-share-row">
        <a class="social-button facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://example.com" target="_blank">
          <i class="fab fa-facebook-f"></i> Facebook
        </a>
        <a class="social-button twitter" href="https://twitter.com/intent/tweet?url=https://example.com" target="_blank">
          <i class="fab fa-twitter"></i> Twitter
        </a>
        <a class="social-button whatsapp" href="https://api.whatsapp.com/send?text=Confira%20isso:%20https://example.com" target="_blank">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        <a class="social-button email" href="mailto:?subject=Confira isso&body=Veja este link: https://example.com">
          <i class="fas fa-envelope"></i> Email
        </a>
        <a class="social-button threads" href="https://www.threads.net/share?url=https://example.com" target="_blank">
          <i class="fas fa-at"></i> Threads
        </a>
    </div>
</div>


<script>
  const form = document.getElementById("form-comentario");
  if (form) {
    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const comentario = document.getElementById("comentario").value;

      fetch("/api/comentarios/", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-CSRFToken": "{{ csrf_token }}",
        },
        body: JSON.stringify({ texto: comentario }),
      })
      .then(res => res.json())
      .then(data => {
        alert("Comentário enviado!");
        form.reset();
      })
      .catch(err => {
        alert("Erro ao enviar.");
        console.error(err);
      });
    });
  }
</script>

   

  {% include 'footer.html' %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
